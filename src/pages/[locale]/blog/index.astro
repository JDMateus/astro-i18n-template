---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import { LOCALES } from '../../../constants';
import MainLayout from '../../../layouts/MainLayout.astro';

export function getStaticPaths() {
  return LOCALES.map(locale => ({ params: { locale } }));
}

const { locale } = Astro.params;

const posts = await getCollection('blog', data => data.id.startsWith(locale));
---

<style>
  img {
    place-self: initial;
    border-radius: 12px;
    margin-bottom: 16px;
  }

  h4 {
    margin: 0;
  }
</style>

<MainLayout locale={locale}>
  <section>
    {
      posts.map(post => {
        const [_, slug] = post.slug.split('/');

        return (
          <article>
            <a href={`/${locale}/blog/${slug}`}>
              <Image width={300} height={200} src={post.data.heroImage} alt='' />
              <h4>{post.data.title}</h4>
              <time>{post.data.pubDate}</time>
            </a>
          </article>
        );
      })
    }
  </section>
</MainLayout>
